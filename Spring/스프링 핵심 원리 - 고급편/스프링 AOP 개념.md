##스프링 AOP 개념

### 1. AOP 개요

AOP(Aspect-Oriented Programming, 관점 지향 프로그래밍)는 소프트웨어 개발에서 핵심 기능과 부가 기능을 분리하는 방법을 제공합니다. 핵심 기능은 애플리케이션의 주요 로직(예: 주문 서비스)이지만, 부가 기능은 핵심 기능을 보조하는 기능(예: 로깅, 트랜잭션 관리 등)입니다. AOP는 부가 기능을 핵심 로직에서 분리하고 이를 효율적으로 관리할 수 있도록 돕습니다.

#### 핵심 기능과 부가 기능

- 핵심 기능: 애플리케이션에서 제공하는 주요 기능으로, 예를 들어 OrderService의 주문 처리 로직.

- 부가 기능: 핵심 기능을 지원하는 추가적인 로직으로, 예를 들어 로그 추적, 트랜잭션 처리 등이 포함됩니다. 부가 기능은 핵심 기능과 결합되어 함께 실행되지만, 독립적으로 사용되지 않으며 여러 기능에서 공통적으로 필요할 수 있습니다.

### 문제점

부가 기능은 애플리케이션 전반에 걸쳐 사용되지만, 이를 각각의 클래스에서 관리하는 것은 비효율적입니다. 예를 들어, 부가 기능을 100개 클래스에 각각 적용해야 한다면 코드 중복이 발생하고 수정 시 모든 클래스에서 변경을 해야 하는 번거로움이 있습니다.

---

### 2. AOP의 해결책: 애스펙트(Aspect)

애스펙트는 부가 기능과 해당 부가 기능을 적용할 대상을 정의한 모듈입니다. 애스펙트는 핵심 로직과 부가 기능을 분리하고, 부가 기능이 적용될 위치를 지정합니다. 예를 들어, "모든 컨트롤러에서 로그를 출력하라"는 규칙을 정의할 수 있습니다. 이를 통해 AOP는 애플리케이션 전반에 부가 기능을 일관되게 적용할 수 있도록 합니다.

### 3. AOP 적용 방식

AOP는 주로 세 가지 방식으로 부가 기능을 적용합니다:

1. 컴파일 시점: 자바 컴파일러를 통해 .class 파일을 만들 때 부가 기능이 코드에 삽입됩니다. 이를 **위빙(Weaving)**이라 부릅니다. 그러나 이 방식은 특별한 컴파일러가 필요하고 복잡합니다.

2. 클래스 로딩 시점: 자바의 클래스 로더가 .class 파일을 로딩하는 과정에서 부가 기능이 적용됩니다. 이 방법은 주로 **로드 타임 위빙(Load-Time Weaving)**이라 불립니다. 그러나 추가적인 설정이 필요하고, 운영이 번거롭습니다.

3. 런타임 시점(프록시): 자바 프로그램 실행 후, 스프링과 같은 프레임워크에서 프록시를 사용하여 부가 기능을 적용합니다. 이 방식은 가장 널리 사용되며, 스프링 AOP에서 주로 사용됩니다.

---

### 4. AOP 적용 위치

AOP는 다음과 같은 다양한 지점에서 적용할 수 있습니다:

- 메서드 실행

- 생성자 실행

- 필드 값 접근

- static 메서드 접근

스프링 AOP는 주로 메서드 실행에 AOP를 적용할 수 있으며, 프록시 방식을 사용합니다. 이에 따라 메서드 오버라이딩이 가능하지만, 생성자나 필드 접근 등 다른 지점에는 AOP를 적용할 수 없습니다.

### 5. AOP의 장점

AOP의 주요 장점은 핵심 로직과 부가 기능을 분리하여 코드의 중복을 줄이고, 부가 기능을 효율적으로 관리할 수 있게 해준다는 점입니다. 예를 들어, 트랜잭션 관리나 로깅 같은 부가 기능을 여러 클래스에서 공통적으로 사용할 때 AOP를 통해 간편하게 적용할 수 있습니다.

### 6. AOP의 제약과 차이점

- 프록시 방식의 제약: 스프링 AOP는 프록시 방식을 사용하기 때문에, 메서드 실행에만 AOP를 적용할 수 있습니다. AspectJ와 같은 다른 AOP 프레임워크는 더 복잡하고 더 많은 기능을 제공하지만, 설정과 구현이 더 어렵습니다.

- 스프링 AOP와 AspectJ의 차이: 스프링 AOP는 프록시 방식으로 동작하고, AspectJ는 더 다양한 지점에서 AOP를 적용할 수 있는 기능을 제공합니다. AspectJ는 더 복잡하지만, AOP의 강력한 기능을 제공합니다.

### 7. AOP 구현

스프링에서는 @Aspect 애너테이션을 사용하여 애스펙트를 정의하고, @Before, @After, @Around와 같은 어드바이스(부가 기능)를 통해 부가 기능을 메서드에 적용합니다. 예를 들어, 로그를 남기거나, 메서드 실행 전후에 트랜잭션을 관리하는 등의 작업을 할 수 있습니다.

### 결론

스프링 AOP는 핵심 기능과 부가 기능을 분리하여 코드의 유지보수성을 높이고, 부가 기능을 효율적으로 관리할 수 있는 방법을 제공합니다. 프록시 방식을 사용하여 메서드 실행 시점에 부가 기능을 적용하며, AspectJ와 같은 다른 AOP 프레임워크는 더 강력한 기능을 제공하지만 더 복잡한 설정이 필요합니다.
